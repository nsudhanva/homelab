apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyProxy
metadata:
  name: tailscale-proxy
  namespace: tailscale
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
spec:
  extraArgs:
  - --buffer-limit=33554432
  provider:
    type: Kubernetes
    kubernetes:
      envoyService:
        type: LoadBalancer
        loadBalancerClass: tailscale
        externalTrafficPolicy: Cluster
        annotations:
          tailscale.com/hostname: gateway-envoy
          tailscale.com/tags: tag:k8s
